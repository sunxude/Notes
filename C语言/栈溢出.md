[[栈]]溢出是指程序访问超出栈空间的内存区域
例如：
```
int a[5] = {0};
a[6] = 1;
//////////////////////////
#include <stdio.h>
 
int factorial(int n) {
    if (n == 0) {
        return 1;
    } else {
        return n * factorial(n - 1);
    }
}
 
int main() {
    int n = 1000; // 递归层次过深
    printf("Factorial of %d is %d\n", n, factorial(n));
    return 0;
}
```
这里就会发生栈溢出。
### 栈溢出的常见原因
1. [[递归]]调用：如果递归的层次过深，导致栈空间不足。
2. [[大数组]]：函数中使用了一个非常大的数组，且大小超过了栈空间，可能导致溢出。
3. 栈空间分配不足：未正确指定栈空间的大小，可能导致栈溢出。
### 栈溢出的检测及处理
操作系统通过内存管理器来检测非法内存访问，它负责跟踪每个程序的内存分配情况，并确保只能访问其分配的内存区域。当操作系统检测到栈溢出的时候，它会通过异常处理机制来处理这种错误。操作系统检测到栈溢出的时候，它会采取以下措施：
1. 停止程序的执行
2. 记录错误信息
3. 通知用户或开发者
### 避免栈溢出
1. 限制递归的深度：使用递归时，确保递归层次不会超过栈空间大小。
2. 使用动态内存分配:需要大数组的时候，使用动态内存（如malloc、calloc等）分配，而不是用静态数组。
3. 设置栈空间大小：编译时，设置足够的栈空间大小。
```
#include <stdio.h>
#include <stdlib.h>

int factorial(int n)
{
	int *arr = malloc(n * sizeof(int));
	if(arr == NULL)
		return -1;//处理内存分配失败的情况。
	for(int i =0;i <n;i++)
		arr[i] = i;
	free(arr);
	return 0;
}
int main()
{
	int n = 1000;
	factorial(n);
	return 0;
}
```
malloc函数动态分配内存，free函数释放内存。